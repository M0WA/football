./migrate-resource.sh extend infongt-eu6:icpu16:istore2a 50g
operation=extend
res=infongt-eu6:icpu16:istore2a
target_percent=50g
Sourcing hooks in './hooks-cm3.sh'
Using clustermw username: 'tschoebeltheuer'
Determined the following CURRENT hypervisor: "icpu16"
Determined the following CURRENT primary: "istore2a"
PING icpu16.schlund.de (10.46.0.131) 56(84) bytes of data.
64 bytes from icpu16.schlund.de (10.46.0.131): icmp_seq=1 ttl=59 time=0.535 ms

--- icpu16.schlund.de ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.535/0.535/0.535/0.000 ms
PING istore2a.schlund.de (10.46.98.4) 56(84) bytes of data.
64 bytes from istore2a.schlund.de (10.46.98.4): icmp_seq=1 ttl=60 time=0.550 ms

--- istore2a.schlund.de ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.550/0.550/0.550/0.000 ms
/mars is a mountpoint
  infongt-eu6 UpToDate Replicating DCASFR Primary istore2a 
/vol/infongt-eu6 is a mountpoint
Determined the following secondaries: 'icpu5138
icpu5139
istore2b'
PING icpu5138.schlund.de (10.46.12.76) 56(84) bytes of data.
64 bytes from icpu5138.schlund.de (10.46.12.76): icmp_seq=1 ttl=59 time=0.515 ms

--- icpu5138.schlund.de ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.515/0.515/0.515/0.000 ms
PING icpu5139.schlund.de (10.46.28.76) 56(84) bytes of data.
64 bytes from icpu5139.schlund.de (10.46.28.76): icmp_seq=1 ttl=58 time=1.32 ms

--- icpu5139.schlund.de ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 1.328/1.328/1.328/0.000 ms
PING istore2b.schlund.de (10.46.102.2) 56(84) bytes of data.
64 bytes from istore2b.schlund.de (10.46.102.2): icmp_seq=1 ttl=59 time=1.22 ms

--- istore2b.schlund.de ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 1.221/1.221/1.221/0.000 ms
Determined the following VG name: "vg2a"
Determined the following LV path: "/dev/vg2a/infongt-eu6"
Determined USED  space: 993564
Determined TOTAL space: 19990528
Computed TARGET  space: 52428800
Computed DELTA   space: 32439296
vg2a REST space on 'istore2a' :   21506990080
vginfong REST space on 'icpu5138' :   7184683008
vginfong REST space on 'icpu5139' :   7184683008
vg2b REST space on 'istore2b' :   21514457088
[CONFIRM: Press Return to continue, ^C to abort] 
Running hook: hook_get_mountpoint hook_get_mountpoint infongt-eu6
Running hook: hook_get_vg hook_get_vg istore2a
Executing on istore2a: 'vgs | awk '{ print $1; }' | grep 'vginfong\|vg[0-9]\+[ab]''
Executing on istore2a: 'lvresize -L 52428800k /dev/vg2a/infongt-eu6'
  Extending logical volume infongt-eu6 to 50.00 GiB
  Logical volume infongt-eu6 successfully resized
Running hook: hook_get_vg hook_get_vg icpu5138
Executing on icpu5138: 'vgs | awk '{ print $1; }' | grep 'vginfong\|vg[0-9]\+[ab]''
Executing on icpu5138: 'lvresize -L 52428800k /dev/vginfong/infongt-eu6'
  Size of logical volume vginfong/infongt-eu6 changed from 19.07 GiB (4883 extents) to 50.00 GiB (12800 extents).
  Logical volume infongt-eu6 successfully resized
Running hook: hook_get_vg hook_get_vg icpu5139
Executing on icpu5139: 'vgs | awk '{ print $1; }' | grep 'vginfong\|vg[0-9]\+[ab]''
Executing on icpu5139: 'lvresize -L 52428800k /dev/vginfong/infongt-eu6'
  Size of logical volume vginfong/infongt-eu6 changed from 19.07 GiB (4883 extents) to 50.00 GiB (12800 extents).
  Logical volume infongt-eu6 successfully resized
Running hook: hook_get_vg hook_get_vg istore2b
Executing on istore2b: 'vgs | awk '{ print $1; }' | grep 'vginfong\|vg[0-9]\+[ab]''
Executing on istore2b: 'lvresize -L 52428800k /dev/vg2b/infongt-eu6'
  Extending logical volume infongt-eu6 to 50.00 GiB
  Logical volume infongt-eu6 successfully resized
Executing on istore2a: 'marsadm resize infongt-eu6'
---------------------------- check preconditions:
old_size=20480786432
possible_size=20480786432
new_size=20480786432
WARNING: You are wasting 33206304768 bytes locally
---------------------------- set new size:
---------------------------- wait for change:
Device size is now 20480786432.
Running hook: hook_extend_iscsi hook_extend_iscsi icpu16
Executing on icpu16: 'iscsiadm -m session -R'
Rescanning session [sid: 2, target: iqn.2003-11.de.schlund:infongt-eu6.icpu16.schlund.de, portal: 10.46.65.1,3260]
Executing on icpu16: 'xfs_growfs -d /vol/infongt-eu6'
data size unchanged, skipping
meta-data=/dev/sdb               isize=256    agcount=1024, agsize=4883 blks
         =                       sectsz=512   attr=2, projid32bit=1
         =                       crc=0        finobt=0
data     =                       bsize=4096   blocks=5000192, imaxpct=25
         =                       sunit=0      swidth=0 blks
naming   =version 2              bsize=4096   ascii-ci=0 ftype=0
log      =internal               bsize=4096   blocks=2560, version=2
         =                       sectsz=512   sunit=0 blks, lazy-count=1
realtime =none                   extsz=4096   blocks=0, rtextents=0
DONE Tue Jul 11 08:46:29 CEST 2017
